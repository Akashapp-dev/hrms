:root{
  --brand-black:#000000;
  --brand-white:#ffffff;
  --brand-red:#d40028;
  --brand-green:#009257;
  --brand-gray:#40444e;
  --brand-blue:#00497b;

  --bg:var(--brand-white);
  --fg:var(--brand-black);
  --muted:#6b7280;
  --card:#ffffff;
  --border:#e5e7eb;
  --accent:var(--brand-red);
  --accent-contrast:#ffffff;

  --container-max: 1480px;
  --drawer-w: 240px;
  --page-pad: 20px;
  --topbar-h: 48px;

  --preview-zoom: 1;

  /* Images & fades */
  --login-bg-img: url("assets/images/ltcorp-polygon.png");
  --app-bg-fade-from: rgba(212,0,40,.25);
  --app-bg-fade-to: rgba(212,0,40,0);
}

/* Font: Avenir Next World Bold (local if available) */
@font-face{
  font-family:"Avenir Next World";
  src:local("Avenir Next World Bold"), local("Avenir Next World");
  font-weight:700;
  font-style:normal;
  font-display:swap;
}

*{ box-sizing:border-box }
html, body { min-height: 100%; }
body{
  margin:0;
  font-family:"Avenir Next World", system-ui, Segoe UI, Roboto, Ubuntu, sans-serif;
  background:var(--bg);
  color:var(--fg);
  font-size:14px;
  line-height:1.45;
  position:relative;
  padding-top: var(--topbar-h); /* keep content below fixed header */
}

/* ===== Global LT_CORP background (every screen) ===== */
body::before{
  content: "";
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  background:
    linear-gradient(to top, var(--app-bg-fade-from) 0%, var(--app-bg-fade-to) 55%),
    var(--login-bg-img) center/cover no-repeat; /* no 'fixed' → smooth */
  background-color: #fff; /* fallback */
}

header,footer{ padding:12px 16px; border-bottom:1px solid var(--border) }
footer{ border-top:1px solid var(--border); border-bottom:none }

h1{ margin:0; font-size:20px; font-weight:700 }
h2{ margin:12px 0 8px; font-size:16px; font-weight:700 }
h3{ margin:12px 0 6px; font-size:14px; color:var(--muted); font-weight:700 }

@media (min-width:1440px){
  body{ font-size:15px }
  h1{ font-size:22px } h2{ font-size:18px } h3{ font-size:15px }
}

.container{ max-width:var(--container-max); margin:0 auto; width:100%; padding:0 var(--page-pad) }
.grid{ display:grid; grid-template-columns:1fr; gap:16px; padding:16px }
@media (min-width:1000px){ .grid{ grid-template-columns:1fr 1fr } }

.topbar{
  display:flex; gap:12px; align-items:center;
  position: fixed; /* keep header visible while scrolling */
  top: 0; left: 0; right: 0;
  height: var(--topbar-h);
  z-index: 10010; /* above overlays */
  background: var(--card);
}
.burger{
  padding:3px 8px;
  font-size:12px;
  line-height:1;
  background:var(--brand-red);
  border:none;
  color:#fff;
  border-radius:4px;
}
.userinfo{ margin-left:0; color:var(--muted) }
#logout-btn{
  margin-left:auto; padding:4px 10px; font-size:12px; line-height:1.2;
  background:transparent; border:1px solid var(--border); color:#111827
}
#logout-btn:hover{ background:#f3f4f6 }

section{ background:var(--card); padding:12px; border:1px solid var(--border); border-radius:8px }
.row{ display:flex; gap:8px; align-items:center; flex-wrap:wrap }
input,textarea,select,button{
  width:100%; padding:8px; border-radius:6px; border:1px solid var(--border);
  background:#ffffff; color:var(--fg);
  transition:border-color .15s ease, box-shadow .15s ease, background-color .15s ease;
}
input::placeholder,textarea::placeholder{ color:#9aa3ad }
input:focus-visible,textarea:focus-visible,select:focus-visible{
  outline:none; border-color:var(--accent); box-shadow:0 0 0 3px rgba(212,0,40,.18)
}
button{ width:auto; cursor:pointer; background:var(--accent); color:var(--accent-contrast); border:none }
button:hover{ filter:brightness(.96) }
button:active{ transform:translateY(1px) }
button:disabled{ opacity:.5; cursor:not-allowed }
label{ display:block; margin-top:8px; margin-bottom:4px; color:var(--muted) }

/* Button variants */
.secondary{ background:#f3f4f6 !important; color:#111827 !important; border:1px solid var(--border) !important }
.secondary:hover{ filter:none; background:#e5e7eb !important }
.success{ background:var(--brand-green) !important; color:#fff !important }
.danger{ background:#b91c1c !important; color:#fff !important }

/* Utility */
.hidden{ display:none !important }
body.guest #logout-btn{ display:none !important }

ul{ list-style:none; padding:0; margin-top:8px }
ul li{ padding:6px; border:1px solid var(--border); border-radius:6px; margin-bottom:6px; background:#ffffff }

/* Drawer */
.drawer{
  position:fixed; top:var(--topbar-h); left:0; width:var(--drawer-w);
  background:#ffffff; border-right:1px solid var(--border);
  height:calc(100% - var(--topbar-h)); padding:12px 8px;
  display:flex; flex-direction:column; gap:6px; z-index:10
}
.drawer a{ color:#1f2937; text-decoration:none; padding:8px; border-radius:6px }
.drawer a:hover{ background:#f3f4f6 }
.drawer.hidden{ display:none }

.page{ padding:16px; margin-left:0 }
body.nav-open .page{ padding-left: calc(16px + var(--drawer-w) + 16px) }

@media (min-width:900px){
  .burger{ display:none }
  .drawer{ display:flex }
  /* On desktop, ignore the 'hidden' class so nav is always visible */
  .drawer.hidden{ display:flex }
  /* Page gets left padding for docked drawer by default */
  .page{ padding-left: calc(16px + var(--drawer-w) + 16px) }
}

.center{ max-width:820px; margin:40px auto }
.vcenter{ min-height:calc(100vh - 96px); display:flex; align-items:center }

/* Template grid layout */
.tpl-grid{ display:grid; grid-template-columns:1fr; gap:16px; padding:16px }
/* New templates layout */
.templates-grid{ display:grid; grid-template-columns:1fr; gap:16px; padding:16px }
@media (min-width:1100px){ .templates-grid{ grid-template-columns: 1fr 1.6fr } }
.list-panel select#template-list{ width:100%; height: 280px }
.editor-panel .field-grid{ display:grid; grid-template-columns:1fr; gap:10px 16px }
@media (min-width:1100px){ .editor-panel .field-grid{ grid-template-columns:1fr 1.1fr } }
.editor-panel textarea#template-content{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  min-height: 380px;
  line-height: 1.45;
}
.editor-panel .help{ color: var(--muted); margin-top:6px }

/* ≥1280px: Templates | Data (wider) | Preview (smaller) */
@media (min-width:1280px){
  .tpl-grid{ grid-template-columns: 1fr 1.6fr 1fr }
}
@media (min-width:1600px){
  .tpl-grid{ grid-template-columns: 1 fr 1.7fr 1fr }
}

/* Data section inputs: horizontal */
.tpl-grid > section:nth-child(2){
  display:grid;
  grid-template-columns: repeat(2, minmax(240px,1fr));
  gap:10px 16px;
}
@media (min-width:1600px){
  .tpl-grid > section:nth-child(2){ grid-template-columns: repeat(3, minmax(220px,1fr)); }
}
.tpl-grid > section:nth-child(2) label{ margin:0 0 2px; font-size:12px; line-height:1.2; color:#6b7280 }

/* ================= Editor + Preview (Compose) ================= */
/* Smaller placeholders panel + larger preview, full content visible */
.editor-preview{
  display:grid;
  grid-template-columns: minmax(260px, 0.8fr) 1.2fr; /* smaller left, bigger preview */
  gap:16px;
  align-items:start;
}
@media (min-width:1280px){
  .editor-preview{
    grid-template-columns: minmax(280px, 0.75fr) 1.25fr;
  }
}
@media (max-width:900px){ .editor-preview{ grid-template-columns:1fr } }

/* Preview shows entire A4 (no clipping) */
.preview-panel{
  position: static;        /* remove sticky to avoid cut-off */
}
.preview-panel .preview-toolbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border:1px solid var(--border);
  background:#fff;
  border-radius:8px;
  padding:8px 10px;
}
.preview-panel .preview-toolbar h3{ margin:0; }
.zoom-controls{ display:flex; align-items:center; gap:6px }
.zoom-controls button{ padding:6px 10px; border-radius:6px; font-size:13px }
.preview-scroll{
  height: auto;
  max-height: 85vh;        /* show more preview; internal scroll for long content */
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  border:1px solid var(--border);
  border-radius:8px;
  background:#ffffff;
  padding:12px;
  overscroll-behavior: contain; /* prevent window scroll while interacting */
}
#preview, #preview *{ background:#fff; color:#000 !important }
/* Invisible anchors used to auto-scroll preview to the edited placeholder */
.ph-anchor{ display:inline-block; width:0; height:0; overflow:hidden; opacity:0; }

/* A4 page */
.a4-page{
  background:#fff; color:#000;
  margin:0 auto;
  box-shadow:0 0 0 1px #e5e7eb, 0 3px 12px rgba(0,0,0,.08); /* lighter for perf */
  width:210mm; min-height:297mm;
  /* Provide extra space for letterhead at top and footer at bottom */
  padding:30mm 16mm 20mm 16mm; /* top | right | bottom | left */
  transform:scale(var(--preview-zoom));
  transform-origin: top left;
}
.preview-scroll .a4-page{ min-width:calc(210mm * var(--preview-zoom)) }
@media (min-width:1440px){ :root{ --preview-zoom:1.05 } }
@media (min-width:1920px){ :root{ --preview-zoom:1.15 } }
@media print{ .a4-page{ transform:none } }

/* Print-friendly page-break behavior (preview + print) */
@media print{
  /* Avoid splitting important blocks across pages */
  p, h1, h2, h3, h4, h5, h6,
  ul, ol, li,
  table, thead, tbody, tr,
  blockquote, pre {
    page-break-inside: avoid;
    break-inside: avoid;
  }
  /* Reduce orphan/widow lines for paragraphs */
  p { orphans: 3; widows: 3; }
  /* Respect explicit page break markers */
  .page-break { page-break-before: always; break-before: page; }
}

/* Tight text */
.a4-page p,.a4-page li,.a4-page td,.a4-page th{ margin:4px 0; line-height:1.38 }
.a4-page h1{ margin:10px 0 6px } .a4-page h2{ margin:8px 0 6px } .a4-page h3{ margin:8px 0 6px }
.a4-page ol, .a4-page ul{ margin:6px 0; padding-left:18px }

/* Responsive tweaks */
@media (max-width:767px){
  .tpl-grid{ grid-template-columns:1fr; gap:12px; padding:12px }
  .tpl-grid > section:nth-child(2){ grid-template-columns:1fr }
  .preview-panel{ position:static }
  .preview-scroll{ height:auto; max-height:none; overflow: visible }
  :root{ --preview-zoom:0.85 }
}
@media (min-width:768px) and (max-width:1279px){
  .tpl-grid{ grid-template-columns:1fr }
  .editor-preview{ grid-template-columns:1fr 1fr }
  .tpl-grid > section:nth-child(2){ grid-template-columns:repeat(2, minmax(220px,1fr)) }
}

/* ================= Compose: Placeholders & Common Fields ================ */
.placeholders-panel {
  min-width: 0;
  font-family: "Avenir Next World", Arial, sans-serif;
  color: #111827;
  background:#fff;
  border:1px solid var(--border);
  border-radius:8px;
  padding:14px 12px;
  max-width: 440px; /* keep panel compact */
  box-shadow: 0 2px 8px rgba(0,0,0,.04);
}

/* tidy grid rows for vars + common fields */
.placeholders-panel #vars .row,
.placeholders-panel #custom-fields .row{
  display:grid;
  grid-template-columns: 120px 1fr;   /* label | input */
  align-items:start;
  gap:12px;
  margin-bottom:10px;
}

/* Enhanced placeholder rows */
.placeholders-panel .placeholder-row{
  background: #fafafa;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 10px;
}
.placeholders-panel .placeholder-row:hover{ background:#f9fafb }

/* labels */
.placeholders-panel #vars label,
.placeholders-panel #custom-fields label{
  font-size:13px;
  color:#374151;
  font-weight:700;
  margin:0;
  text-align:left;     /* move name text to the left */
  padding-right:0;     /* free up space for input */
  white-space:normal;
  word-break:break-word;
  overflow:visible;
  text-overflow:clip;
}

.placeholders-panel .placeholder-row label{
  color:#111827;
}

/* inputs */
.placeholders-panel input{
  padding:10px 12px;
  font-size:14px;
  border:1px solid #d1d5db;
  border-radius:8px;
  background:#fff;
  color:#111827;
  width:100%;
  transition:border-color .15s ease, box-shadow .15s ease;
}
.placeholders-panel textarea{
  padding:10px 12px;
  font-size:14px;
  border:1px solid #d1d5db;
  border-radius:8px;
  background:#fff;
  color:#111827;
  width:100%;
  min-height:38px;
  line-height:1.4;
  resize: vertical;
  transition:border-color .15s ease, box-shadow .15s ease;
}
.placeholders-panel textarea::placeholder{ color:#9aa3ad }
.placeholders-panel input:focus-visible{
  outline:none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(212,0,40,.18);
}
.placeholders-panel textarea:focus-visible{
  outline:none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(212,0,40,.18);
}

/* headings */
.placeholders-panel h3.subhead{
  margin:12px 0 8px;
  font-size:14px;
  font-weight:800;
  color:#111827;
}

/* hint text (if present) */
.placeholders-panel .hint{ color:#6b7280; font-size:12px }

/* badges (used in Users) */
.badge{ display:inline-block; padding:2px 8px; border-radius:999px; font-size:11px; font-weight:700; line-height:1; border:1px solid #e5e7eb; background:#f9fafb; color:#374151 }
.badge.admin{ background:#fee2e2; color:#991b1b; border-color:#fecaca }
.badge.editor{ background:#e0e7ff; color:#3730a3; border-color:#c7d2fe }
.badge.viewer{ background:#dcfce7; color:#166534; border-color:#bbf7d0 }

/* stack nicely on small screens */
@media (max-width:700px){
  .placeholders-panel{
    max-width: 100%;
  }
  .placeholders-panel #vars .row,
  .placeholders-panel #custom-fields .row{
    grid-template-columns: 1fr; /* label above input */
  }
  .placeholders-panel #vars label,
  .placeholders-panel #custom-fields label{
    text-align:left;
    padding-right:0;
  }
}

/* ================== Admin Users / Profile (kept) ================== */
.users-grid{ display:grid; grid-template-columns:1fr; gap:16px }
@media (min-width: 1000px){ .users-grid{ grid-template-columns: 1.1fr 1.6fr } }
.user-list{ display:grid; grid-template-columns:1fr; gap:10px }
@media (min-width: 700px){ .user-list{ grid-template-columns:repeat(2, minmax(220px, 1fr)) } }
@media (min-width: 1200px){ .user-list{ grid-template-columns:repeat(3, minmax(220px, 1fr)) } }
.user-card{ display:flex; align-items:center; gap:10px; padding:10px; background:var(--card); border:1px solid var(--border); border-radius:8px; cursor:pointer; text-align:left }
.user-card:hover{ background:#fafafa }
.user-card.selected{ outline:2px solid var(--accent) }
.user-card .avatar{ width:36px; height:36px; border-radius:999px; display:flex; align-items:center; justify-content:center; background:#f3f4f6; color:#b91c1c; font-weight:700 }
.user-card .meta{ display:flex; flex-direction:column; gap:2px }
.user-card .name{ font-weight:700 }
.user-card .username{ color:var(--muted); font-size:12px }
.user-detail{ background:var(--card); border:1px solid var(--border); border-radius:8px; padding:12px }
.user-header{ display:flex; align-items:center; gap:12px }
.user-header .avatar.lg{ width:44px; height:44px; border-radius:999px; display:flex; align-items:center; justify-content:center; background:#f3f4f6; color:#b91c1c; font-weight:800 }
.user-actions{ display:flex; gap:8px; flex-wrap:wrap }

/* Profile */
.profile-card{ max-width:780px; }
.profile-header{ display:flex; align-items:center; gap:12px; margin-bottom:12px }
.profile-header .avatar.xl{ width:64px; height:64px; border-radius:999px; background:#f3f4f6; color:#b91c1c; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:22px }
.profile-header .meta{ display:flex; flex-direction:column; gap:4px }
.profile-header .name{ font-weight:700; font-size:18px }
.profile-header .username{ color:var(--muted); font-size:13px }
.profile-grid{ display:grid; grid-template-columns:1fr; gap:10px }
@media (min-width:720px){ .profile-grid{ grid-template-columns:1fr 1fr } }
.profile-grid .item{ display:flex; align-items:center; justify-content:space-between; gap:12px; border:1px solid var(--border); border-radius:8px; padding:10px; background:#ffffff }
.profile-grid .item label{ margin:0; color:#b0b7c3; font-size:13px }
.profile-grid .item .value{ font-weight:600; color:#111827 }

/* ========== Login Page (overlay retains same background) ========== */
.login-page{
  position: fixed; /* overlay the app (below topbar) */
  top: var(--topbar-h);
  left: 0; right: 0; bottom: 0;
  display: grid;
  place-items: center;
  overflow: hidden;
  background: var(--brand-white); /* fallback */
  z-index: 10000; /* below topbar */
}
.login-page::before{
  content:"";
  position:absolute; inset:0;
  background:
    linear-gradient(to top, rgba(212,0,40,.25) 0%, rgba(212,0,40,0) 55%),
    var(--login-bg-img) center/cover no-repeat; /* no 'fixed' → smooth */
}

.login-layout{
  position: relative;
  width: min(1220px, 92vw);
  min-height: clamp(520px, 70vh, 780px);
  display: grid;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  gap: clamp(24px, 5vw, 64px);
  padding: clamp(16px, 3vw, 32px);
}
.login-layout::after{
  content:"";
  position:absolute;
  inset-block: 6%;
  left: 50%;
  width: 1px;
  background: rgba(0,0,0,.12);
  transform: translateX(-50%);
  pointer-events: none;
}

.login-left{ display: grid; place-items: center; padding: clamp(10px, 2vw, 24px); }
.login-logo-img{
  width: clamp(180px, 26vw, 360px);
  height: auto;
  display: block;
  filter: drop-shadow(0 4px 16px rgba(0,0,0,.18));
}

.login-right{ display: grid; place-items: center; }

.login-card{
  width: min(420px, 86vw);
  border: 1px solid var(--border);
  border-radius: 14px;
  background: #ffffffCC;
  -webkit-backdrop-filter: blur(2px); /* lighter blur for perf */
  backdrop-filter: blur(2px);
  box-shadow: 0 6px 18px rgba(0,0,0,.10); /* lighter shadow for perf */
  padding: clamp(16px, 3.4vw, 28px);
}

.login-card h1,
.login-card .title{
  margin: 0 0 8px;
  font-size: clamp(18px, 2.4vw, 22px);
  font-weight: 700;
  color: #111827;
}
.login-card .subtitle{
  margin: 0 0 16px;
  color: #6b7280;
  font-size: 14px;
}

.login-card label{
  color: #6b7280;
  font-size: 13px;
  margin: 10px 0 6px;
}
.login-card input[type="text"],
.login-card input[type="password"],
.login-card input[type="email"]{
  background: #fff;
  color: #111827;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 10px 12px;
  transition: border-color .15s ease, box-shadow .15s ease;
}
.login-card input:focus-visible{
  outline: none;
  border-color: var(--brand-red);
  box-shadow: 0 0 0 3px rgba(212,0,40,.18);
}

.login-card .btn,
.login-card button[type="submit"]{
  margin-top: 10px;
  width: 100%;
  border: none;
  border-radius: 10px;
  background: var(--brand-red);
  color: #fff;
  font-weight: 700;
  padding: 12px 14px;
  cursor: pointer;
  transition: transform .06s ease, box-shadow .15s ease, background .15s ease;
  box-shadow: 0 6px 16px rgba(212,0,40,.20);
}
.login-card .btn:hover{ background:#bb0023; }
.login-card .btn:active{ transform: translateY(1px); }
.login-card .btn:disabled{ opacity:.6; cursor:not-allowed; box-shadow:none; }

.login-card .links{
  margin-top: 10px;
  display: flex;
  justify-content: space-between;
  gap: 8px;
  font-size: 13px;
}
.login-card .links a{ color: var(--brand-blue); text-decoration: none; }
.login-card .links a:hover{ text-decoration: underline; }

@media (max-width: 900px){
  .login-layout{
    grid-template-columns: 1fr;
    gap: 20px;
    min-height: auto;
  }
  .login-layout::after{ display: none; }
  .login-left{ padding-block: 20px 0; }
  .login-logo-img{ width: clamp(180px, 44vw, 320px); }
}

@media (max-width: 420px){
  .login-card{ padding: 16px; border-radius: 12px; }
}

/* ===================== SMOOTH SCROLL + PERF PATCH ===================== */
html { scroll-behavior: smooth; }

@supports (content-visibility: auto){
  .preview-scroll,
  .templates-grid,
  .tpl-grid,
  .users-grid,
  .profile-card{
    content-visibility: auto;
    contain-intrinsic-size: 1000px;
  }
}

.preview-scroll,
.page {
  backface-visibility: hidden;
  -webkit-font-smoothing: antialiased;
}

/* Safety override: ensure header is pinned on all screens */
header.topbar{
  position: fixed !important;
  top: 0 !important;
  left: 0; right: 0;
  height: var(--topbar-h);
  z-index: 10010;
  background: var(--card);
}
.page{ min-height: calc(100vh - var(--topbar-h)); }

/* Optional: mobile-specific lighter background image if available
@media (max-width: 900px){
  :root{
    --login-bg-img: url("assets/images/ltcorp-polygon.png");
  }
}
*/
